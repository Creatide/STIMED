!function(t){t.stimed=function(){function e(){this.dt=new Date,this.speedUpCounter=0,this.timeout,this.update()}function r(){this.stylesAll=[],this.totalTargets=0,this.totalStyles=0,this.initStyles=0}function n(t,e){e=e?e:"",l.settings.debugging&&console.log("**",u,"**",t,e)}var o,i,s,a={timeTarget:null,fps:30,timeRunning:!0,precise:!1,speedUp:0,debugging:!0},u="STIMED.JS",l=this;l.settings={},Array.prototype.slice.call(arguments).forEach(function(t){"object"==typeof t&&t.length?t.attr("class").length?a.timeTarget="."+t.attr("class"):t.attr("id").length&&(a.timeTarget="#"+t.attr("id")):s=t});var p=function(){l.settings=t.extend({},a,s),o=new e,i=new r};l.time={start:function(){l.settings.timeRunning=!0,o.update()},stop:function(){l.settings.timeRunning=!1},get:function(){return t.inArray(arguments[0],["t","tt","tc","time","timecode"])>-1?o.get.timecode():t.inArray(arguments[0],["s","ss","sec","second","seconds"])>-1?o.get.seconds():t.inArray(arguments[0],["ms","millisecond","milliseconds"])>-1?o.get.milliseconds():t.inArray(arguments[0],["p","pos","position","percent"])>-1?o.get.position(arguments[1]):void 0}},l.style={update:function(){i.update()},create:function(){i.create(arguments)},logStyles:function(){i.logStyles()},preset:function(){i.preset(arguments)}},e.prototype.update=function(){if(this.dt=new Date,l.settings.speedUp>0&&(this.speedUpCounter+=Math.round(.234*l.settings.speedUp),this.dt.setSeconds(this.dt.getSeconds()+this.speedUpCounter)),this.ms=this.dt.getMilliseconds(),this.ss=c.leadingZeros(this.dt.getSeconds()),this.mm=c.leadingZeros(this.dt.getMinutes()),this.hh=c.leadingZeros(this.dt.getHours()),this.txt=this.hh+":"+this.mm+":"+this.ss,l.settings.timeTarget&&this.renderTime(l.settings.timeTarget),i&&r.prototype.update(),l.settings.timeRunning){var t=this;this.timeout=setTimeout(function(){return t.update()},1e3/l.settings.fps)}else clearTimeout(this.timeout)},e.prototype.get={timecode:function(){return c.secondsToTime(this.seconds())},milliseconds:function(){var t=new Date(o.dt),e=Math.floor(o.dt-t.setHours(0,0,0,0));return e},seconds:function(){var t=new Date(o.dt),e=Math.floor((o.dt-t.setHours(0,0,0,0))/1e3);return e},position:function(t){var t=void 0===t?0:t;if(0===t)return Math.round(this.seconds()/86400*100);var e=parseInt(c.trailingZeros(1,t,0));return(Math.round(this.seconds()/86400*e)/e).toFixed(t)}},e.prototype.renderTime=function(e){var r=this;t(e).each(function(){t(this).text(r.txt)})},r.prototype.update=function(){i.totalStyles?i.loopStyles(function(t,e){for(var r,n=o.get.seconds(),s=o.get.milliseconds(),a=l.settings.precise?s:n,u=l.settings.precise?1e3:1,p=86400*u,f=e.values.length,g=0;g<f;g++){var d,h=e.values[g],y=h.time*u,m=c.arrayNext(e.values,g,!0),v=m[0].time*u;m[1]?p-y+v:v-y;if(!m[1]&&a>=y&&a<v){d=c.normalize(y,v,a),r=i.updateStyleValues(h,m[0],d,t);break}if(m[1]&&a>=y){d=c.normalize(y,y+v,a),r=i.updateStyleValues(h,m[0],d,t);break}if(m[1]&&a<v&&a<y){d=c.normalize(y-p,v,a),r=i.updateStyleValues(h,m[0],d,t);break}}i.updateDOM(t,e.property,r)}):n("Styles not found!")},r.prototype.create=function(){var e=Array.prototype.slice.call(arguments[0]),r=["target","time","property","value"];e.forEach(function(e){t.isArray(e)?i.create(e):i.validateStyle(e,r)&&i.createStyleObject(e),i.totalStyles++}),this.sortStyles("time")},r.prototype.createStyleObject=function(e){var r=c.searchObjectIndex(this.stylesAll,"target",e.target),n={target:e.target,styles:[{property:e.property,values:[{time:c.timeToSeconds(e.time),value:e.value}]}]};if(null===r)this.stylesAll.push(n),this.totalTargets++;else{var o=t.grep(this.stylesAll[r].styles,function(t){return t.property===e.property});o.length?o[0].values.push(n.styles[0].values[0]):this.stylesAll[r].styles.push(n.styles[0])}},r.prototype.updateStyleValues=function(t,e,r,o){function i(){o=o?o:"",n("Style attribute error on "+o,[t,e])}var s=t.value.toString().split(" "),a=s.length,u=e.value.toString().split(" "),l=u.length;if(a===l){for(var p=[],f=0;f<a;f++){var g=null,d=c.findHexColorString(s[f]),h=c.findHexColorString(u[f]);if(c.breakWords(s[f])||(g=d&&h?c.colorLerp(d[0],h[0],r):null,g||(g=c.lerpStringNumbers(s[f],u[f],r))),g||(g=s[f]),!g){i();break}p.push(g)}return p.join(" ")}i()},r.prototype.validateStyle=function(t,e){var r=[];return e.forEach(function(e){e in t||r.push(e)}),!r.length||void n(t.target+" missing properties:",r)},r.prototype.sortStyles=function(t){this.loopStyles(function(e,r){r.values.sort(c.sortBy(t,!1,parseInt))})},r.prototype.logStyles=function(){this.loopStyles(function(t,e){n("Style found for "+t,e.property+": "+JSON.stringify(e.values))})},r.prototype.loopStyles=function(t){this.stylesAll.forEach(function(e){e.styles.forEach(function(r){t(e.target,r)})})},r.prototype.updateDOM=function(e,r,n){n&&t(e).css(r,n)},r.prototype.preset=function(){var e=Array.prototype.slice.call(arguments[0]),r={preset:null,found:!1};e.forEach(function(e){t.isArray(e)?i.preset(e):(r.preset=e,"string"==typeof e&&(e={preset:e}),i.preset.presets.forEach(function(t,n){c.onlyChars(t.preset)===c.onlyChars(e.preset)&&i.validateStyle(e,i.preset.presets[n].required)&&(i.preset.presets[n].create(e),r.found=!0)}))}),r.found||n("Preset not work properly:",r.preset)};var c={arrayNext:function(t,e,r){return r&&e>=t.length-1?[t[0],!0]:[t[++e],!1]},arrayPrev:function(t,e,r){return r&&e<=0?[t[t.length-1],!0]:[t[--e],!1]},isArray:function(t){return!!t&&Array===t.constructor},searchObjectIndex:function(e,r,n){if(t.isArray(e))for(var o=0;o<e.length;o++)if(e[o][r]==n)return o;return null},sortBy:function(t,e,r){var n=r?function(e){return r(e[t])}:function(e){return e[t]};return e=e?-1:1,function(t,r){return t=n(t),r=n(r),e*((t>r)-(r>t))}},isInt:function(t){return Number(t)===t&&t%1===0},isFloat:function(t){return Number(t)===t&&t%1!==0},lerp:function(t,e,r){return t+r*(e-t)},lerpStringNumbers:function(e,r,n,o){if(o=o||2,aArr=e.match(/-?\d*[,.]?\d+/g),bArr=r.match(/-?\d*[,.]?\d+/g),t.isArray(aArr)&&t.isArray(bArr)&&aArr.length===bArr.length)return e.replace(/-?\d*[,.]?\d+/g,function(t){var e=c.lerp(Number(t),bArr.shift(),n);return c.isFloat(e)&&(e=e.toFixed(o)),e})},normalize:function(t,e,r){return Math.round((r-t)/(e-t)*1e4)/1e4},clamp:function(t,e,r){return Math.max(t,Math.min(r,e))},randomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},breakWords:function(t){var e=["url"];if(new RegExp("\\b"+e.join("\\b|\\b")+"\\b").test(t))return!0},leadingZeros:function(t){return("0"+t).slice(-2)},trailingZeros:function(t,e,r){for(t="string"!=typeof t?t.toString():t;t.length<=e;)t+=r;return t},onlyChars:function(t){return t="string"!=typeof t?t.toString():t,t.replace(/\s+/g,"").toLowerCase()},isURL:function(t){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(t)},secondsToTime:function(t){var e=parseInt(t,10),r=Math.floor(e/3600),n=Math.floor((e-3600*r)/60),o=e-3600*r-60*n;return c.leadingZeros(r)+":"+c.leadingZeros(n)+":"+c.leadingZeros(o)},timeToSeconds:function(t){if("string"==typeof t&&t.split(":").length>1){for(var e=t.split(":");e.length<3;)e.push(0);return 60*+e[0]*60+60*+e[1]+(+e[2]||0)}return t=parseInt(t),t>=0&&t<=86400?t:t>86400?86400:t<0?0:void 0},colorLerp:function(t,e,r){if(t=c.expandHex(t),e=c.expandHex(e),t!==e){var n=parseInt(t.replace(/#/g,""),16),o=n>>16,i=n>>8&255,s=255&n,a=parseInt(e.replace(/#/g,""),16),u=a>>16,l=a>>8&255,p=255&a,f=o+r*(u-o),g=i+r*(l-i),d=s+r*(p-s);return"#"+((1<<24)+(f<<16)+(g<<8)+d|0).toString(16).slice(1)}return t},expandHex:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;return t=t.replace(e,function(t,e,r,n){return e+e+r+r+n+n})},findHexColorString:function(t){var e=/^#([0-9a-f]{3}|[0-9a-f]{6})$/i;return t.match(e)},replaceHexColorString:function(t,e){var r=/^#([0-9a-f]{3}|[0-9a-f]{6})$/i;return t.replace(r,e)},randomHexColor:function(t){function e(t){var e=255-t,r=0|Math.random()*e+t,n=r.toString(16);return 1==n.length?"0"+n:n}return t=t>255?255:t,"#"+e(t)+e(t)+e(t)}};p(),r.prototype.preset.presets=[{preset:"Rotate",required:["target"],create:function(t){var e=t.from||0,r=void 0==t.to?360:t.to;i.create([{target:t.target,time:"0",property:"-ms-transform",value:"rotate("+e+"deg)"},{target:t.target,time:"86400",property:"-ms-transform",value:"rotate("+r+"deg)"},{target:t.target,time:"0",property:"-webkit-transform",value:"rotate("+e+"deg)"},{target:t.target,time:"86400",property:"-webkit-transform",value:"rotate("+r+"deg)"},{target:t.target,time:"0",property:"transform",value:"rotate("+e+"deg)"},{target:t.target,time:"86400",property:"transform",value:"rotate("+r+"deg)"}])}},{preset:"Random Values",required:["target"],create:function(t){for(var e=t.property||"font-size",r=t.delay||1e3,n=t.min||"40",o=t.max||"100",s=t.unit||"px",a=Math.ceil(86400/r),u=[],l=0,p=0;p<a;p++){var f={target:t.target,time:l,property:e,value:c.randomInt(parseInt(n),parseInt(o))+s};u.push(f),l+=r}i.create(u)}},{preset:"Random Colors",required:["target"],create:function(t){for(var e=t.property||"color",r=t.delay||1e3,n=Math.ceil(86400/r),o=t.brightness||0,s=[],a=0,u=0;u<n;u++){var l={target:t.target,time:a,property:e,value:c.randomHexColor(o)};s.push(l),a+=r}i.create(s)}},{preset:"Unsplash",required:["target"],create:function(e){function r(){for(var t=0;t<a;t++)v.push(m[c.randomInt(0,b-1)].id);for(;A<=86400;){var r=h;f&&(r+="g/"),r+=u+"/"+l+"?image="+v[S],p&&(r+="&blur"),d&&(r+="&gravity="+d),o&&((new Image).src=r);var g={target:e.target,time:A,property:n,value:'url("'+r+'")'};if(x.push(g),S++,A+=s,S==a)break}i.create(x)}var n=e.property||"background-image",o=void 0==e.preload||e.preload,s=e.delay||1e3,a=Math.ceil(86400/s),u=e.width||1920,l=e.height||1080,p=e.blur||!1,f=e.grayscale||!1,g=["north","east","south","west","center"],d=g.indexOf(e.gravity)!=-1&&e.gravity,h="https://unsplash.it/",y="https://unsplash.it/list",m=[],v=[],S=0,b=0,x=[],A=0;t(function(){t.getJSON(y).done(function(t){m=t}).always(function(){b=m.length,r()})})}}]}}(jQuery);